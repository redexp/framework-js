Контроллер
==========

- Структура
- Приём параметров
- Передача данных
- Класс Controller
- Класс Request
- Класс Response

## Структура

Контроллеры являются [модулями](http://nodejs.org/api/modules.html).

Пример
```javascript
exports.getUsers = function(){
    return User.getAll();
};

exports.getUser = function(id){
    return User.getByPk(id);
};
```

Имена методов могут быть произвольными.
Связь запроса с методом описывается в конфиге роутинга.

**this** внутри методов является объектом класса Controller

## Приём параметров

Метод, который связан с роутом, получает параметры запроса в виде аргументов.

Пример метода, который связан с роутом ```/post?user_id=100&status=published```
```javascript
exports.getPost = function(userId, status) {
    return User.find({user_id: userId, status: status});
}
```

Соответственно второй способ получить все параметры можно из массива arguments.

Последний способ это получить параметры из объекта класса Request вызвав метод ```this.getRequest()```

## Передача данных

Всё что вернёт метод контроллера будет передано вьюшке, которая по умолчанию будет искать файл, с темже именем что и метод, в папке **views** того же модуля.
Имя файла можно поменять как в роутинге, так и в методе контроллера ```this.getView().setName('value')```.

Вьюшка (обработчик результатов контроллера) может быть не только HTML, но и например JSON, т.е. результат контроллера будет сериалезирован в JSON строку.

## Класс Controller

- **getRequest()** Возвращает объект класса Request
- **getResponse()** Возвращает объект класса Response
- **getView()** Возвращает объект класса View
- **setView(view)** Устанавливает объект класса View
- **redirectTo(url)** Редиректит на указанный url

## Класс Request

- **get(ops)** Возвращает объект с именами параметров в его полях и их значениями.
  Необязательный параметр - объект **ops** может иметь поле *method:* для фильтрации параметров по имени HTTP метода (GET, POST и т.д.)
- **getHeaders()** Возвращает объект параметров HTTP заголовка запроса (Content-Type, Accept и т.д.)

## Класс Response

- **getBody()** Возвращает тело ответа
- **setBody(text)** Устанавливает тело ответа
- **getHeaders()** Возвращает HTTP заголовок
- **getHeader(name)** Возвращает параметр HTTP заголовока
- **setHeader(name, value)** Устанавливает параметр HTTP заголовока
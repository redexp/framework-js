Контроллер
==========

- Структура
- Приём параметров
- Передача данных
- Класс Controller
- Класс Request
- Класс Response

## Структура

Контроллеры будут представляться в виде файлов в которых будет описан [модуль CommonJS](http://habrahabr.ru/post/130035/).

Пример
```javascript
this.getUsers = function(){
    return User.getAll();
};

this.getUser = function(id){
    return User.getByPk(id);
};
```

Имена методов могут быть произвольными.
Связь запроса с методом описывается в конфиге роутинга.

**this** внутри методов является объектом класса Controller

## Приём параметров

Метод, который связан с роутом, получает параметры запроса в виде аргументов.

Пример метода, который связан с роутом ```/post?user_id=100&status=published```
```javascript
this.getPost = function(userId, status) {
    return User.find({user_id: userId, status: status});
}
```

Соответственно второй способ получить все параметры можно из массива arguments.

Последний способ - это получит параметры вызвав метод ```this.getRequest().get()``` который вернёт объект как показано на примере
```javascript
{
    user_id: "100",
    status:  "published",
}
```

## Передача данных

Всё что вернёт метод контроллера по умолчанию будет передано вьюшке с таким же именем как и сам метод.
Имя вьюшки которой нужно передать данные можно поменять как в роутинге, так и в методе контроллера ```this.setView(name)```.

Результаты метода могут быть перехвачены по событию ```controller.action``` и обработынны без передачи их вьюшке.

## Класс Controller

- **getRequest()** Возвращает объект класса Request
- **getResponse()** Возвращает объект класса Response
- **getView()** Возвращает имя файла вьюшки
- **setView(name)** Устанавливает имя файла вьюшки

## Класс Request

- **get()** Возвращает объект с именами параметров в его полях и их значениями
- **getMethod(name)** Возвращает объект параметров определённого HTTP метода (GET, POST, PUT и т.д.)
- **getHeaders()** Возвращает объект параметров HTTP заголовка запроса (Content-Type, Accept и т.д.)

## Класс Response

- **getBody()** Возвращает тело ответа
- **setBody(text)** Устанавливает тело ответа
- **getHeaders()** Возвращает HTTP заголовок
- **getHeader(name)** Возвращает параметр HTTP заголовока
- **setHeader(name, value)** Устанавливает параметр HTTP заголовока